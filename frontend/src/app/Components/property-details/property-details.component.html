<div class="container">
    <div class="property-header">
        <h1 class="property-title"> {{property.title}} </h1>
        <p class="property-location"><i class="bi bi-geo-fill"></i> {{property.city}}, {{property.country}} </p>
        <div class="property-price">MAD {{property.price}}/night</div>
        <div class="property-rating">
            <div class="rating-stars">
              @for (i of createRange(property.avrgReview); track i) {
                 <span class="star">★</span>
              }
            </div>
            @if (property.avrgReview > 0) {
              <div class="rating-score">{{property.avrgReview}}</div>
            }@else {
              <div class="rating-score"></div>
            }
            <!-- <div class="rating-count">(127 reviews)</div> -->
        </div>
    </div>

    <div class="image-gallery">
        <div class="main-image">
            <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="main-property-image">
        </div>
        <div class="thumbnail-grid">
            <div class="thumbnail">
              <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="exterior">
            </div>
            <div class="thumbnail">
              <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="interior">
            </div>
            <div class="thumbnail">
              <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="Kitchen">
            </div>
            <div class="thumbnail">
              <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="bedroom">
            </div>
        </div>
    </div>

    <div class="property-details">
        <div class="details-main">
            <h2 class="section-title"> {{property.title}} </h2>
            <div class="property-features">
                <div class="feature-item">
                    <div class="feature-icon"><i class="bi bi-house-door-fill"></i></div>
                    <div>
                        <strong>Property Type</strong><br>
                        {{property.propertyType.toLowerCase()}}
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="bi bi-bounding-box"></i></div>
                    <div>
                        <strong>Area</strong><br>
                        {{property.area}} m²
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-bed"></i></div>
                    <div>
                        <strong>Bedrooms</strong><br>
                        {{property.roomsNumber}}
                        @if(property.roomsNumber > 1){
                          Bedrooms
                        }@else {
                          Bedroom
                        }
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-bath"></i></div>
                    <div>
                        <strong>Bathrooms</strong><br>
                        {{property.bathroomsNumber}}
                        @if(property.bathroomsNumber > 1){
                          Full Bathrooms
                        }
                        @if(property.bathroomsNumber === 1){
                          Full Bathroom
                        }
                    </div>
                </div>
            </div>

            <h2 class="section-title">Description</h2>
            <p style="margin-bottom: 2rem; line-height: 1.8;">
                {{property.description}}
            </p>

            <h2 class="section-title">Amenities & Features</h2>
            <div class="amenities-grid">
              @for (item of property.features; track $index) {
                <div class="amenity-item">
                  <div class="amenity-check"><i class="bi bi-check2"></i></div>
                  <span> {{item}} </span>
                </div>
              }
            </div>
        </div>

        <div class="details-sidebar">
            <form class="booking-card" [formGroup]="reservation" (ngSubmit)="onSubmit()">
                <div class="booking-price">MAD{{property.price}} </div>
                <div class="booking-period">per night</div>

                <div class="booking-form">
                    <div class="form-group">
                        <label>Move-in Date</label>
                        <input type="date" formControlName="startDate"/>
                    </div>
                    <div class="form-group">
                        <label>End-duration Date</label>
                        <input type="date" formControlName="endDate" />
                    </div>
                  </div>

                  @if (clickedReservation) {
                    <div class="alert">
                      <i class="bi bi-calendar2-check"></i> Reservation sent successfully!
                    </div>
                  }@else{
                    <button class="book-now-btn" type="submit">Schedule Viewing</button>
                  }
            </form>

            <div class="contact-info">
                <h3 class="section-title">Contact Agent</h3>
                <div class="contact-item">
                    <div class="contact-icon"><i class="bi bi-person-vcard"></i></div>
                    <div>
                        <strong> {{owner.firstName}} {{owner.lastName}} </strong><br>
                        Real Estate Agent
                    </div>
                </div>
                <div class="contact-item">
                  <div class="contact-icon"><i class="bi bi-telephone-fill"></i></div>
                  <div>
                      <strong>Phone</strong><br>
                      {{owner.phone}}
                  </div>
                </div>
                <div class="contact-item">
                    <div class="contact-icon"><i class="bi bi-envelope-at"></i></div>
                    <div>
                        <strong>Email</strong><br>
                        {{owner.email}}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
