<div class="container">
    <div class="property-header">
        <h1 class="property-title"> {{property.title}} </h1>
        <p class="property-location"><i class="bi bi-geo-fill"></i> {{property.city}}, {{property.country}} </p>
        <div class="property-price">MAD {{property.price}}/night</div>
        <div class="property-rating">
            <div class="rating-stars">
              @for (i of createRange(property.avrgReview); track i) {
                 <span class="star">★</span>
              }
            </div>
            @if (property.avrgReview > 0) {
              <div class="rating-score">{{property.avrgReview}}</div>
            }@else {
              <div class="rating-score"></div>
            }
            <!-- <div class="rating-count">(127 reviews)</div> -->
        </div>
    </div>

    <div class="image-gallery">
        <div class="main-image">
            <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="main-property-image">
        </div>
        <div class="thumbnail-grid">
            <div class="thumbnail">
              <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="exterior">
            </div>
            <div class="thumbnail">
              <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="interior">
            </div>
            <div class="thumbnail">
              <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="Kitchen">
            </div>
            <div class="thumbnail">
              <img src="https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80" alt="bedroom">
            </div>
        </div>
    </div>

    <div class="property-details">
        <div class="details-main">
            <h2 class="section-title"> {{property.title}} </h2>
            <div class="property-features">
                <div class="feature-item">
                    <div class="feature-icon"><i class="bi bi-house-door-fill"></i></div>
                    <div>
                        <strong>Property Type</strong><br>
                        {{property.propertyType.toLowerCase()}}
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="bi bi-bounding-box"></i></div>
                    <div>
                        <strong>Area</strong><br>
                        {{property.area}} m²
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-bed"></i></div>
                    <div>
                        <strong>Bedrooms</strong><br>
                        {{property.roomsNumber}}
                        @if(property.roomsNumber > 1){
                          Bedrooms
                        }@else {
                          Bedroom
                        }
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-bath"></i></div>
                    <div>
                        <strong>Bathrooms</strong><br>
                        {{property.bathroomsNumber}}
                        @if(property.bathroomsNumber > 1){
                          Full Bathrooms
                        }
                        @if(property.bathroomsNumber === 1){
                          Full Bathroom
                        }
                    </div>
                </div>
            </div>

            <h2 class="section-title">Description</h2>
            <p style="margin-bottom: 2rem; line-height: 1.8;">
                {{property.description}}
            </p>

            <h2 class="section-title">Amenities & Features</h2>
            <div class="amenities-grid">
              @for (item of property.features; track $index) {
                <div class="amenity-item">
                  <div class="amenity-check"><i class="bi bi-check2"></i></div>
                  <span> {{item}} </span>
                </div>
              }
            </div>
        </div>

        <div class="details-sidebar">
            <form class="booking-card" [formGroup]="reservation" (ngSubmit)="onSubmit()">
                <div class="booking-price">MAD{{property.price}} </div>
                <div class="booking-period">per night</div>

                <div class="booking-form">
                    <div class="form-group">
                        <label>Move-in Date</label>
                        <input type="date" formControlName="startDate"/>
                    </div>
                    <div class="form-group">
                        <label>End-duration Date</label>
                        <input type="date" formControlName="endDate" />
                    </div>
                  </div>

                  @if (clickedReservation) {
                    <div class="alert">
                      <i class="bi bi-calendar2-check"></i> Reservation sent successfully!
                    </div>
                  }@else{
                    <button class="book-now-btn" type="submit">Schedule Viewing</button>
                  }
            </form>

            <div class="contact-info">
                <h3 class="section-title">Contact Agent</h3>
                <div class="contact-item">
                    <div class="contact-icon"><i class="bi bi-person-vcard"></i></div>
                    <div>
                        <strong> {{owner.firstName}} {{owner.lastName}} </strong><br>
                        Real Estate Agent
                    </div>
                </div>
                <div class="contact-item">
                  <div class="contact-icon"><i class="bi bi-telephone-fill"></i></div>
                  <div>
                      <strong>Phone</strong><br>
                      {{owner.phone}}
                  </div>
                </div>
                <div class="contact-item">
                    <div class="contact-icon"><i class="bi bi-envelope-at"></i></div>
                    <div>
                        <strong>Email</strong><br>
                        {{owner.email}}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Reviews Section -->
    <div class="reviews-section">
        <h2 class="section-title">Reviews & Ratings</h2>

        <!-- Review Form -->
        <div class="review-form">
            <h3>Leave a Review</h3>
            <form>
                <div class="rating-input">
                    <label>Your Rating:</label>
                    <div class="star-rating">
                        <input type="radio" id="star5" name="rating" value="5">
                        <label for="star5">★</label>
                        <input type="radio" id="star4" name="rating" value="4">
                        <label for="star4">★</label>
                        <input type="radio" id="star3" name="rating" value="3">
                        <label for="star3">★</label>
                        <input type="radio" id="star2" name="rating" value="2">
                        <label for="star2">★</label>
                        <input type="radio" id="star1" name="rating" value="1">
                        <label for="star1">★</label>
                    </div>
                </div>

                <div class="comment-input">
                    <label for="comment">Your Comment:</label>
                    <textarea id="comment" name="comment" placeholder="Share your experience about this property..."></textarea>
                </div>

                <button type="submit" class="submit-review-btn">Submit Review</button>
            </form>
        </div>

        <!-- Reviews List -->
        <div class="reviews-list">
          <div class="review-item">
            <div class="review-header">
              <div class="reviewer-info">
                <div class="reviewer-avatar">S</div>
                <div>
                  <div class="reviewer-name">Sarah Johnson</div>
                  <div class="review-date">March 15, 2024</div>
                </div>
              </div>
              <div class="review-rating">
                <span class="star">★</span>
                <span class="star">★</span>
                <span class="star">★</span>
                <span class="star">★</span>
                <span class="star">★</span>
              </div>
            </div>
            <div class="review-comment">
              Absolutely amazing property! The villa exceeded all our expectations. Beautiful architecture, great amenities, and perfect location. The host was very responsive and helpful. Would definitely stay here again!
            </div>
          </div>

          <div class="review-item">
              <div class="review-header">
                  <div class="reviewer-info">
                      <div class="reviewer-avatar">M</div>
                      <div>
                          <div class="reviewer-name">Mohammed Al-Rashid</div>
                          <div class="review-date">February 28, 2024</div>
                      </div>
                  </div>
                  <div class="review-rating">
                      <span class="star">★</span>
                      <span class="star">★</span>
                      <span class="star">★</span>
                      <span class="star">★</span>
                      <span class="star empty">★</span>
                  </div>
              </div>
              <div class="review-comment">
                  Great property with excellent facilities. The swimming pool was a highlight for our family. Only minor issue was the WiFi could be stronger in some areas, but overall a fantastic stay.
              </div>
          </div>

          <div class="review-item">
              <div class="review-header">
                  <div class="reviewer-info">
                      <div class="reviewer-avatar">L</div>
                      <div>
                          <div class="reviewer-name">Lisa Chen</div>
                          <div class="review-date">January 10, 2024</div>
                      </div>
                  </div>
                  <div class="review-rating">
                      <span class="star">★</span>
                      <span class="star">★</span>
                      <span class="star">★</span>
                      <span class="star">★</span>
                      <span class="star">★</span>
                  </div>
              </div>
              <div class="review-comment">
                  Perfect for a family vacation! Spacious, clean, and well-maintained. The location is convenient for exploring Casablanca. Ahmed was an excellent host and made sure we had everything we needed.
              </div>
          </div>
      </div>
    </div>
</div>
